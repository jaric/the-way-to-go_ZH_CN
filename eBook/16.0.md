# 16 常見的陷阱與錯誤

在之前的內容中，有時候使用`!!...!!`標記警告go語言中的一些錯誤使用方式。當你在編程時候遇到的一個困難，可以確定本書特定的章節能找到類似的主題。爲了方便起見，這裏列出了一些常見陷進，以便於你能發現更多的解釋和例子：

- 永遠不要使用形如 `var p*a` 聲明變量，這會混淆指針聲明和乘法運算（參考[4.9小節](04.9.md)）
- 永遠不要在`for`循環自身中改變計數器變量（參考[5.4小節](05.4.md)）
- 永遠不要在`for-range`循環中使用一個值去改變自身的值（參考[5.4.4小節](05.4.md)）
- 永遠不要將`goto`和前置標籤一起使用（參考[5.6小節](05.6.md)）
- 永遠不要忘記在函數名（參考[第6章](06.0.md)）後加括號()，尤其調用一個對象的方法或者使用匿名函數啓動一個協程時
- 永遠不要使用`new()`一個map，一直使用make（參考[第8章](08.0.md)）
- 當爲一個類型定義一個String()方法時，不要使用`fmt.Print`或者類似的代碼（參考[10.7小節](10.7.md)）
- 永遠不要忘記當終止緩存寫入時，使用`Flush`函數（參考[12.2.3小節](12.2.md)）
- 永遠不要忽略錯誤提示，忽略錯誤會導致程序奔潰（參考[13.1小節](13.1.md)）
- 不要使用全局變量或者共享內存，這會使併發執行的代碼變得不安全（參考[14.1小節](14.1.md)）
- `println`函數僅僅是用於調試的目的

最佳實踐：對比以下使用方式：

- 使用正確的方式初始化一個元素是切片的映射，例如`map[type]slice`（參考[8.1.3小節](08.1.md)）
- 一直使用逗號，ok或者checked形式作爲類型斷言（參考[11.3小節](11.3.md)）
- 使用一個工廠函數創建並初始化自己定義類型（參考[10.2小節](10.2.md)-[18.4小節](18.4.md)）
- 僅當一個結構體的方法想改變結構體時，使用結構體指針作爲方法的接受者，否則使用一個結構體值類型[10.6.3小節](10.6.md)

本章主要彙總了go語言使用過程中最常見的錯誤和注意事項。在之前的章節已經涉及到了完整的示例和解釋，你應該做的不僅僅是閱讀這段的標題。

## 鏈接

- [目錄](directory.md)
- 上一章：[使用SMTP（簡單郵件傳輸協議）發送郵件](15.12.md)
- 下一節：[誤用短聲明導致變量覆蓋](16.1.md)